<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">LLM Open Connector + Hugging Face | Einstein Platform Cookbook</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://opensource.salesforce.com/einstein-platform/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://opensource.salesforce.com/einstein-platform/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://opensource.salesforce.com/einstein-platform/huggingface"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="LLM Open Connector + Hugging Face | Einstein Platform Cookbook"><meta data-rh="true" name="description" content="Learn how to implement Salesforce&#x27;s LLM Open Connector with the Hugging Face Serverless Inference API for LLM models that support Chat Completion. We also cover how to implement and deploy the connector as a Node.js app on Heroku."><meta data-rh="true" property="og:description" content="Learn how to implement Salesforce&#x27;s LLM Open Connector with the Hugging Face Serverless Inference API for LLM models that support Chat Completion. We also cover how to implement and deploy the connector as a Node.js app on Heroku."><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2024-09-12T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/msrivastav13"><meta data-rh="true" property="article:tag" content="huggingface,heroku,llm-open-connector"><link data-rh="true" rel="icon" href="/einstein-platform/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://opensource.salesforce.com/einstein-platform/huggingface"><link data-rh="true" rel="alternate" href="https://opensource.salesforce.com/einstein-platform/huggingface" hreflang="en"><link data-rh="true" rel="alternate" href="https://opensource.salesforce.com/einstein-platform/huggingface" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://opensource.salesforce.com/einstein-platform/huggingface","mainEntityOfPage":"https://opensource.salesforce.com/einstein-platform/huggingface","url":"https://opensource.salesforce.com/einstein-platform/huggingface","headline":"LLM Open Connector + Hugging Face","name":"LLM Open Connector + Hugging Face","description":"Learn how to implement Salesforce's LLM Open Connector with the Hugging Face Serverless Inference API for LLM models that support Chat Completion. We also cover how to implement and deploy the connector as a Node.js app on Heroku.","datePublished":"2024-09-12T00:00:00.000Z","author":{"@type":"Person","name":"Mohith","description":"Developer Advocate @ Salesforce","url":"https://github.com/msrivastav13","image":"https://github.com/msrivastav13.png"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://opensource.salesforce.com/einstein-platform/","name":"Recipes"}}</script><link rel="alternate" type="application/rss+xml" href="/einstein-platform/rss.xml" title="Einstein Platform Cookbook RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/einstein-platform/atom.xml" title="Einstein Platform Cookbook Atom Feed">

<link rel="preconnect" href="https://www.googletagmanager.com">
<script>window.dataLayer=window.dataLayer||[]</script>
<script>!function(e,t,a,n){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var g=t.getElementsByTagName(a)[0],m=t.createElement(a);m.async=!0,m.src="https://www.googletagmanager.com/gtm.js?id=GTM-PBBJDJ9C",g.parentNode.insertBefore(m,g)}(window,document,"script","dataLayer")</script><link rel="stylesheet" href="/einstein-platform/assets/css/styles.d2a7bbbd.css">
<script src="/einstein-platform/assets/js/runtime~main.4264b71e.js" defer="defer"></script>
<script src="/einstein-platform/assets/js/main.8338afec.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PBBJDJ9C" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>



<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/einstein-platform/"><div class="navbar__logo"><img src="/einstein-platform/img/logo.svg" alt="Einstein Platform Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/einstein-platform/img/logo.svg" alt="Einstein Platform Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Einstein Platform Cookbook</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/einstein-platform/">Recipes</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">API Specs</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/einstein-platform/docs/apis/llm-open-connector">LLM Open Connector</a></li><li><a class="dropdown__link" href="/einstein-platform/docs/apis/models">Models API</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="https://github.com/salesforce/einstein-platform" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent Recipes</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/einstein-platform/about">About the Cookbook 📖</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/einstein-platform/open-connector">Introducing the LLM Open Connector</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/einstein-platform/huggingface">LLM Open Connector + Hugging Face</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/einstein-platform/aws">LLM Open Connector + AWS</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/einstein-platform/groq">LLM Open Connector + Groq</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/einstein-platform/sambanova">LLM Open Connector + SambaNova</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/einstein-platform/ibm">LLM Open Connector + watsonx</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/einstein-platform/mulesoft">LLM Open Connector + MuleSoft + Cerebras</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/einstein-platform/mulesoft-ollama">LLM Open Connector + MuleSoft + Ollama</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/einstein-platform/vertex">LLM Open Connector + Vertex AI</a></li></ul></nav></aside><main class="col col--7"><article><header><h1 class="title_f1Hy">LLM Open Connector + Hugging Face</h1><div class="container_mt6G margin-vert--md"><time datetime="2024-09-12T00:00:00.000Z">September 12, 2024</time> · <!-- -->8 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a class="avatar__photo-link" href="/einstein-platform/authors/msrivastav-13"><img class="avatar__photo authorImage_XqGP" src="https://github.com/msrivastav13.png" alt="Mohith"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="/einstein-platform/authors/msrivastav-13"><span class="authorName_yefp">Mohith</span></a></div><small class="authorTitle_nd0D" title="Developer Advocate @ Salesforce">Developer Advocate @ Salesforce</small><div class="authorSocials_rSDt"><a href="https://github.com/msrivastav13" target="_blank" rel="noopener noreferrer" class="authorSocialLink_owbf" title="GitHub"><svg viewBox="0 0 256 250" width="1em" height="1em" class="authorSocialLink_owbf githubSvg_Uu4N" xmlns="http://www.w3.org/2000/svg" style="--dark:#000;--light:#fff" preserveAspectRatio="xMidYMid"><path d="M128.001 0C57.317 0 0 57.307 0 128.001c0 56.554 36.676 104.535 87.535 121.46 6.397 1.185 8.746-2.777 8.746-6.158 0-3.052-.12-13.135-.174-23.83-35.61 7.742-43.124-15.103-43.124-15.103-5.823-14.795-14.213-18.73-14.213-18.73-11.613-7.944.876-7.78.876-7.78 12.853.902 19.621 13.19 19.621 13.19 11.417 19.568 29.945 13.911 37.249 10.64 1.149-8.272 4.466-13.92 8.127-17.116-28.431-3.236-58.318-14.212-58.318-63.258 0-13.975 5-25.394 13.188-34.358-1.329-3.224-5.71-16.242 1.24-33.874 0 0 10.749-3.44 35.21 13.121 10.21-2.836 21.16-4.258 32.038-4.307 10.878.049 21.837 1.47 32.066 4.307 24.431-16.56 35.165-13.12 35.165-13.12 6.967 17.63 2.584 30.65 1.255 33.873 8.207 8.964 13.173 20.383 13.173 34.358 0 49.163-29.944 59.988-58.447 63.157 4.591 3.972 8.682 11.762 8.682 23.704 0 17.126-.148 30.91-.148 35.126 0 3.407 2.304 7.398 8.792 6.14C219.37 232.5 256 184.537 256 128.002 256 57.307 198.691 0 128.001 0Zm-80.06 182.34c-.282.636-1.283.827-2.194.39-.929-.417-1.45-1.284-1.15-1.922.276-.655 1.279-.838 2.205-.399.93.418 1.46 1.293 1.139 1.931Zm6.296 5.618c-.61.566-1.804.303-2.614-.591-.837-.892-.994-2.086-.375-2.66.63-.566 1.787-.301 2.626.591.838.903 1 2.088.363 2.66Zm4.32 7.188c-.785.545-2.067.034-2.86-1.104-.784-1.138-.784-2.503.017-3.05.795-.547 2.058-.055 2.861 1.075.782 1.157.782 2.522-.019 3.08Zm7.304 8.325c-.701.774-2.196.566-3.29-.49-1.119-1.032-1.43-2.496-.726-3.27.71-.776 2.213-.558 3.315.49 1.11 1.03 1.45 2.505.701 3.27Zm9.442 2.81c-.31 1.003-1.75 1.459-3.199 1.033-1.448-.439-2.395-1.613-2.103-2.626.301-1.01 1.747-1.484 3.207-1.028 1.446.436 2.396 1.602 2.095 2.622Zm10.744 1.193c.036 1.055-1.193 1.93-2.715 1.95-1.53.034-2.769-.82-2.786-1.86 0-1.065 1.202-1.932 2.733-1.958 1.522-.03 2.768.818 2.768 1.868Zm10.555-.405c.182 1.03-.875 2.088-2.387 2.37-1.485.271-2.861-.365-3.05-1.386-.184-1.056.893-2.114 2.376-2.387 1.514-.263 2.868.356 3.061 1.403Z"></path></svg></a></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p>Learn how to implement Salesforce&#x27;s <a href="/einstein-platform/docs/apis/llm-open-connector">LLM Open Connector</a> with the Hugging Face <a href="https://huggingface.co/docs/api-inference/index" target="_blank" rel="noopener noreferrer">Serverless Inference API</a> for LLM models that support <a href="https://huggingface.co/docs/api-inference/en/tasks/chat-completion" target="_blank" rel="noopener noreferrer">Chat Completion</a>. We also cover how to implement and deploy the connector as a Node.js app on Heroku.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a href="#prerequisites" class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites">​</a></h2>
<p>Before you begin, make sure that your local environment meets these prerequisites:</p>
<ol>
<li>Node.js and npm are installed on your local machine.</li>
<li>You have a Heroku account. (Sign up at <a href="https://signup.heroku.com/" target="_blank" rel="noopener noreferrer">https://signup.heroku.com/</a>.)</li>
<li>Heroku CLI is installed on your local machine (<a href="https://devcenter.heroku.com/articles/heroku-cli" target="_blank" rel="noopener noreferrer">https://devcenter.heroku.com/articles/heroku-cli</a>).</li>
<li>Git is installed on your local machine.</li>
<li>You have a Hugging Face account with an API key (<a href="https://huggingface.co/docs/hub/en/security-tokens" target="_blank" rel="noopener noreferrer">https://huggingface.co/docs/hub/en/security-tokens</a>).</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="tutorial-video">Tutorial Video<a href="#tutorial-video" class="hash-link" aria-label="Direct link to Tutorial Video" title="Direct link to Tutorial Video">​</a></h2>
<p>View a walkthrough on using any LLM with the Open Connector on the <a href="https://www.youtube.com/@SalesforceDevs" target="_blank" rel="noopener noreferrer">Salesforce Developers</a> channel:</p>
<div style="width:640px;height:360px"></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="set-up-your-local-environment">Set Up Your Local Environment<a href="#set-up-your-local-environment" class="hash-link" aria-label="Direct link to Set Up Your Local Environment" title="Direct link to Set Up Your Local Environment">​</a></h2>
<ol>
<li>
<p>Clone the einstein-platform repository to your local environment.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> git clone https://github.com/salesforce/einstein-platform.git</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Create a directory for your project:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mkdir llm-open-connector-hf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd llm-open-connector-hf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Locate the source files specific to Hugging Face connector. In the local <code>einstein-platform</code> project directory you cloned in step 1, navigate to the <code>documentation/cookbook-assets/llm-open-connector-huggingface</code> folder. Copy all the files in this folder.</p>
</li>
<li>
<p>Paste the <code>llm-open-connector-huggingface</code> files into the <code>llm-open-connector-hf</code> directory you created in step 2.</p>
</li>
<li>
<p>Install the required dependencies.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">npm install</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="project-structure">Project Structure<a href="#project-structure" class="hash-link" aria-label="Direct link to Project Structure" title="Direct link to Project Structure">​</a></h2>
<p>This section outlines the folder structure of the <code>llm-open-connector-hf</code> directory.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> llm-open-connector-hf/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ├── config/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> │   └── index.js</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ├── controllers/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> │   └── chatController.js</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ├── middleware/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> │   └── index.js</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ├── routes/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> │   └── chat.js</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ├── utils/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> │   └── logger.js</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ├── .gitignore</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ├── .prettierrc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ├── index.js</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ├── package.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> └── Procfile</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="project-description">Project Description<a href="#project-description" class="hash-link" aria-label="Direct link to Project Description" title="Direct link to Project Description">​</a></h3>
<p>The following list provides a functional overview of each folder and file in the <code>llm-open-connector-hf</code> directory.</p>
<ul>
<li><code>config/</code>: Holds configuration settings.<!-- -->
<ul>
<li><code>index.js</code>: Exports configuration options for different environments.</li>
</ul>
</li>
<li><code>controllers/</code>: Manages the request handling logic for the chat API.<!-- -->
<ul>
<li><code>chatController.js</code>: Calls the chat completion API.</li>
</ul>
</li>
<li><code>middleware/</code>: Contains custom middleware functions.<!-- -->
<ul>
<li><code>index.js</code>: Includes functions for API key validation and error handling.</li>
</ul>
</li>
<li><code>routes/</code>: Defines API routes.<!-- -->
<ul>
<li><code>chat.js</code>: Contains endpoints for chat completion functionality.</li>
</ul>
</li>
<li><code>utils/</code>: Utility functions for support tasks.<!-- -->
<ul>
<li><code>logger.js</code>: A custom logger with data sanitization for secure logging.</li>
</ul>
</li>
<li><code>.gitignore</code>: Lists files and directories that are ignored by Git, such as <code>node_modules</code> and sensitive files.</li>
<li><code>.prettierrc</code>: The configuration file for Prettier, which enforces consistent code formatting across the project.</li>
<li><code>index.js</code>: The main application file that initializes the server and routes.</li>
<li><code>package.json</code>: Contains metadata for the project and manages dependencies, scripts, and configurations.</li>
<li><code>Procfile</code>: Specifies process types and commands for deploying the app on platforms like Heroku.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="configure-your-local-environment">Configure Your Local Environment<a href="#configure-your-local-environment" class="hash-link" aria-label="Direct link to Configure Your Local Environment" title="Direct link to Configure Your Local Environment">​</a></h2>
<ol>
<li>
<p>Create a <code>.env</code> file in the root directory of the project and add these variables:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PORT=3000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">HUGGING_FACE_API_KEY=your_hugging_face_api_key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">HUGGING_FACE_API_URL=https://api-inference.huggingface.co/models</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">USE_THIRD_PARTY_ROUTER=false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ALLOWED_ORIGINS=http://localhost:3000,https://your-salesforce-domain.com</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Replace <code>your_hugging_face_api_key</code> with your own Hugging Face API key and adjust the <code>ALLOWED_ORIGINS</code> as needed. Change <code>ALLOWED_ORIGINS</code> to allowlist your Salesforce domain.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>The <code>HUGGING_FACE_API_URL</code> and <code>USE_THIRD_PARTY_ROUTER</code> configuration options are important when using third-party routers like Together AI.</p></div></div>
<ul>
<li>For standard Hugging Face models, use <code>HUGGING_FACE_API_URL=https://api-inference.huggingface.co</code> and <code>USE_THIRD_PARTY_ROUTER=false</code>.</li>
<li>For third-party routers (e.g. Together AI), use <code>HUGGING_FACE_API_URL=https://router.huggingface.co/together</code> and <code>USE_THIRD_PARTY_ROUTER=true</code>.</li>
</ul>
</li>
<li>
<p>Make sure your <code>.gitignore</code> file includes the <code>.env</code> file to avoid accidentally committing sensitive information.</p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="test-your-application-locally">Test Your Application Locally<a href="#test-your-application-locally" class="hash-link" aria-label="Direct link to Test Your Application Locally" title="Direct link to Test Your Application Locally">​</a></h2>
<ol>
<li>
<p>Run your Node.js application locally:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">npm start</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>The server starts on the port specified in your <code>.env</code> file. The default port is 3000.</p>
</li>
<li>
<p>Test the endpoints using a tool like cURL or Postman to ensure they&#x27;re working correctly. Here are two examples:</p>
<p>a. Using a standard Hugging Face model (Mixtral):</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl -X POST http://localhost:3000/chat/completions \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-H &#x27;Content-Type: application/json&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-H &#x27;api-key: &lt;use your HuggingFace access token here&gt;&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-d &#x27;{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;model&quot;: &quot;mistralai/Mixtral-8x7B-Instruct-v0.1&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;messages&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;content&quot;: &quot;What is the capital of Italy?&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;role&quot;: &quot;user&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;max_tokens&quot;: 100,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;temperature&quot;: 0.7,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;n&quot;: 2,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;parameters&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;top_p&quot;: 0.9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>b. Using Qwen through Together AI (requires setting <code>HUGGING_FACE_API_URL=https://router.huggingface.co/together</code> and <code>USE_THIRD_PARTY_ROUTER=true</code>):</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl -X POST http://localhost:3000/chat/completions \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-H &#x27;Content-Type: application/json&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-H &#x27;api-key: &lt;use your Together AI access token here&gt;&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-d &#x27;{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;model&quot;: &quot;Qwen/Qwen2.5-7B-Instruct-Turbo&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;messages&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;content&quot;: &quot;What is the capital of Italy?&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;role&quot;: &quot;user&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;max_tokens&quot;: 100,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;temperature&quot;: 0.7,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;n&quot;: 2,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;parameters&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;top_p&quot;: 0.9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="prepare-for-heroku-deployment">Prepare for Heroku Deployment<a href="#prepare-for-heroku-deployment" class="hash-link" aria-label="Direct link to Prepare for Heroku Deployment" title="Direct link to Prepare for Heroku Deployment">​</a></h2>
<ol>
<li>
<p>Initialize a Git repository in your project directory:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">git init</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Add your files to the repository:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">git add .</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Commit your changes:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">git commit -m &quot;Initial commit&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="update-your-default-branch">Update Your Default Branch<a href="#update-your-default-branch" class="hash-link" aria-label="Direct link to Update Your Default Branch" title="Direct link to Update Your Default Branch">​</a></h2>
<p>To switch the default branch used to deploy apps from <code>master</code> to <code>main</code>, follow these steps:</p>
<ol>
<li>
<p>Create a branch locally:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">git checkout -b main</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Delete the old default branch locally:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">git branch -D master</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now, the local environment only knows about the <code>main</code> branch.</p>
</li>
<li>
<p>Reset the git repository on the Heroku Platform:</p>
<ul>
<li>
<p>Use the <code>heroku-reset</code> command from the <code>heroku-repo</code> CLI plugin. This command does not impact the running application.</p>
</li>
</ul>
<div class="theme-admonition theme-admonition-important admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>important</div><div class="admonitionContent_BuS1"><p>Communicate this change with your team. If other developers are unaware of the reset and push to <code>master</code>, the reset will be overwritten.</p></div></div>
</li>
<li>
<p>To switch the default branch in GitHub, refer to this article: <a href="https://docs.github.com/en/github/administering-a-repository/setting-the-default-branch" target="_blank" rel="noopener noreferrer">Setting the Default Branch</a>.</p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="deploy-to-heroku">Deploy to Heroku<a href="#deploy-to-heroku" class="hash-link" aria-label="Direct link to Deploy to Heroku" title="Direct link to Deploy to Heroku">​</a></h2>
<ol>
<li>
<p>Login to the Heroku CLI:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">heroku login</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Create a Heroku app:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">heroku create your-app-name</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Replace <code>your-app-name</code> with a unique name for your application.</p>
</li>
<li>
<p>Set the API_KEY config var on Heroku:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">heroku config:set HUGGING_FACE_API_KEY=your_api_key_here -a your-app-name</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Replace <code>your_api_key_here</code> with your own API key.</p>
</li>
<li>
<p>Set the ALLOWED_ORIGINS config var on Heroku:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">heroku config:set ALLOWED_ORIGINS=your_salesforce_domain_here -a your-app-name</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Replace <code>your_salesforce_domain_here</code> with your own Salesforce domain.</p>
</li>
<li>
<p>Deploy your app to Heroku:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">git push heroku main</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="test-your-deployed-application">Test Your Deployed Application<a href="#test-your-deployed-application" class="hash-link" aria-label="Direct link to Test Your Deployed Application" title="Direct link to Test Your Deployed Application">​</a></h2>
<p>You can test your deployed application using the deployed API endpoint. Use a tool like cURL or Postman to test the endpoints of your Node.js app:</p>
<ul>
<li>Chat Completions: <code>POST https://your-app-name.herokuapp.com/chat/completions</code></li>
</ul>
<p>To test the <code>chat/completions</code> endpoint with cURL, run this command:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl -X POST https://still-beach-80840-58cbb07ae5f4.herokuapp.com/chat/completions \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-H &#x27;Content-Type: application/json&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-H &#x27;api-key: &lt;use your HuggingFace access token here&gt;&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-d &#x27;{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;model&quot;: &quot;mistralai/Mixtral-8x7B-Instruct-v0.1&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;messages&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;content&quot;: &quot;What is the capital of Italy?&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;role&quot;: &quot;user&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;max_tokens&quot;: 100,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;temperature&quot;: 0.7,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;n&quot;: 2,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;parameters&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;top_p&quot;: 0.9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="bring-your-connected-endpoint-to-salesforce-model-builder">Bring Your Connected Endpoint to Salesforce Model Builder<a href="#bring-your-connected-endpoint-to-salesforce-model-builder" class="hash-link" aria-label="Direct link to Bring Your Connected Endpoint to Salesforce Model Builder" title="Direct link to Bring Your Connected Endpoint to Salesforce Model Builder">​</a></h2>
<p>Follow the instructions in <a href="https://developer.salesforce.com/blogs/2024/10/build-generative-ai-solutions-with-llm-open-connector" target="_blank" rel="noopener noreferrer">this developer blog</a> to use your model in Model Builder. When you activate your model, you can use it within <a href="https://developer.salesforce.com/docs/einstein/genai/guide/get-started-prompt-builder.html" target="_blank" rel="noopener noreferrer">Prompt Builder</a>, the <a href="https://developer.salesforce.com/docs/einstein/genai/guide/models-api.html" target="_blank" rel="noopener noreferrer">Models API</a>, and for building actions using prompt templates in Agent Builder. All these methods provide built-in security offered by the <a href="https://help.salesforce.com/s/articleView?id=sf.generative_ai_trust_layer.htm&amp;type=5" target="_blank" rel="noopener noreferrer">Einstein Trust Layer</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="current-features">Current Features<a href="#current-features" class="hash-link" aria-label="Direct link to Current Features" title="Direct link to Current Features">​</a></h2>
<p>The following list outlines the features included in this recipe:</p>
<ul>
<li>Integration with the <a href="https://huggingface.co/docs/api-inference/index" target="_blank" rel="noopener noreferrer">Hugging Face</a> Serverless Inference API for <a href="https://huggingface.co/docs/api-inference/en/tasks/chat-completion" target="_blank" rel="noopener noreferrer">models</a> that support Chat Completion</li>
<li>Express server with advanced security configurations</li>
<li>CORS configuration with customizable allowed origins</li>
<li>Rate limiting to prevent abuse</li>
<li>API key validation for protected routes</li>
<li>Comprehensive error handling and sanitized logging</li>
<li>Helmet.js integration for enhanced security headers</li>
<li>Chat completion controller with input validation and response reshaping</li>
<li>Optimized message processing:<!-- -->
<ul>
<li>Concatenates multiple system messages into a single message as required by some LLMs</li>
<li>Preserves the order of user and assistant messages</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="api-endpoints">API Endpoints<a href="#api-endpoints" class="hash-link" aria-label="Direct link to API Endpoints" title="Direct link to API Endpoints">​</a></h2>
<ul>
<li>POST <code>/chat/completions</code>: Send a chat message and receive an AI-generated response.<!-- -->
<ul>
<li>The endpoint optimizes message processing by concatenating system messages.</li>
<li>The following example provides two system messages:<!-- -->
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;messages&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;role&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;system&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;content&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;You are a helpful assistant.&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;role&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;system&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;content&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Always be polite.&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;role&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;user&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;content&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Hello!&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;role&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;assistant&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;content&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Hi there!&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;role&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;user&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;content&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;How are you?&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;model&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;gpt-3.5-turbo&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;max_tokens&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">150</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>The API processes the system messages into:<!-- -->
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;messages&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;role&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;system&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;content&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;You are a helpful assistant.\nAlways be polite.&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;role&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;user&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;content&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Hello!&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;role&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;assistant&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;content&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Hi there!&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;role&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;user&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;content&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;How are you?&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;model&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;gpt-3.5-turbo&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;max_tokens&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">150</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="current-security-measures">Current Security Measures<a href="#current-security-measures" class="hash-link" aria-label="Direct link to Current Security Measures" title="Direct link to Current Security Measures">​</a></h2>
<p>The recipe&#x27;s security measures include a Helmet.js configuration, a CORS configuration, rate limiting, API key validation, and sanitized logging.</p>
<p>The following list briefly highlights the current security measures:</p>
<ul>
<li>A Helmet.js configuration with strict security settings:<!-- -->
<ul>
<li>Content Security Policy (CSP) with restrictive directives</li>
<li>Cross-Origin Embedder Policy</li>
<li>Cross-Origin Opener Policy</li>
<li>Cross-Origin Resource Policy</li>
<li>DNS Prefetch Control</li>
<li>Expect-CT header</li>
<li>Frameguard to prevent clickjacking</li>
<li>HTTP Strict Transport Security (HSTS)</li>
<li>IE No Open</li>
<li>X-Content-Type-Options nosniff</li>
<li>Origin-Agent-Cluster header</li>
<li>Permitted Cross-Domain Policies</li>
<li>Referrer-Policy</li>
<li>X-XSS-Protection</li>
</ul>
</li>
<li>A CORS configuration restricts allowed origins.</li>
<li>Rate limits: 100 requests per 15 minutes per IP.</li>
<li>API key validation provides protected routes.</li>
<li>Sanitized logging prevents accidental exposure of sensitive data.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="important-considerations">Important Considerations<a href="#important-considerations" class="hash-link" aria-label="Direct link to Important Considerations" title="Direct link to Important Considerations">​</a></h2>
<ol>
<li>This cookbook uses the <code>mistralai/Mixtral-8x7B-Instruct-v0.1</code> model in the example cURL requests. You can replace it with any supported model. For a list of supported model IDs, see <a href="https://huggingface.co/docs/api-inference/en/tasks/chat-completion" target="_blank" rel="noopener noreferrer">Hugging Face Chat Completion</a>.</li>
<li>Monitor your usage to manage costs, especially if you expect high traffic.</li>
<li>Error handling and input validation must be improved for production use.</li>
<li>Consider implementing further security measures for production use.</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2>
<p>This cookbook demonstrates how to set up an LLM Open Connector using Hugging Face Serverless API for Chat Completion endpoints for various models. For production purposes, remember to use Hugging Face&#x27;s dedicated <a href="https://ui.endpoints.huggingface.co/" target="_blank" rel="noopener noreferrer">Interference Endpoints</a> feature. Always optimize your implementation based on your specific requirements and expected usage patterns.</p></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/einstein-platform/tags/huggingface">huggingface</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/einstein-platform/tags/heroku">heroku</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/einstein-platform/tags/llm-open-connector">llm-open-connector</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/einstein-platform/open-connector"><div class="pagination-nav__sublabel">Newer post</div><div class="pagination-nav__label">Introducing the LLM Open Connector</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/einstein-platform/aws"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">LLM Open Connector + AWS</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li><li><a href="#tutorial-video" class="table-of-contents__link toc-highlight">Tutorial Video</a></li><li><a href="#set-up-your-local-environment" class="table-of-contents__link toc-highlight">Set Up Your Local Environment</a></li><li><a href="#project-structure" class="table-of-contents__link toc-highlight">Project Structure</a><ul><li><a href="#project-description" class="table-of-contents__link toc-highlight">Project Description</a></li></ul></li><li><a href="#configure-your-local-environment" class="table-of-contents__link toc-highlight">Configure Your Local Environment</a></li><li><a href="#test-your-application-locally" class="table-of-contents__link toc-highlight">Test Your Application Locally</a></li><li><a href="#prepare-for-heroku-deployment" class="table-of-contents__link toc-highlight">Prepare for Heroku Deployment</a></li><li><a href="#update-your-default-branch" class="table-of-contents__link toc-highlight">Update Your Default Branch</a></li><li><a href="#deploy-to-heroku" class="table-of-contents__link toc-highlight">Deploy to Heroku</a></li><li><a href="#test-your-deployed-application" class="table-of-contents__link toc-highlight">Test Your Deployed Application</a></li><li><a href="#bring-your-connected-endpoint-to-salesforce-model-builder" class="table-of-contents__link toc-highlight">Bring Your Connected Endpoint to Salesforce Model Builder</a></li><li><a href="#current-features" class="table-of-contents__link toc-highlight">Current Features</a></li><li><a href="#api-endpoints" class="table-of-contents__link toc-highlight">API Endpoints</a></li><li><a href="#current-security-measures" class="table-of-contents__link toc-highlight">Current Security Measures</a></li><li><a href="#important-considerations" class="table-of-contents__link toc-highlight">Important Considerations</a></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Einstein Platform Cookbook</div><ul class="footer__items clean-list"><li class="footer__item"><span class="footer__item"><a class="footer__link-item" href="/einstein-platform/">Recent Recipes</a></span></li><li class="footer__item"><span class="footer__item"><a class="footer__link-item" href="/einstein-platform/docs/apis/llm-open-connector">LLM Open Connector API Spec</a></span></li><li class="footer__item"><span class="footer__item"><a class="footer__link-item" href="/einstein-platform/docs/apis/models">Models API Spec</a></span></li><li class="footer__item"><span class="footer__item"><a href="#" class="footer__link-item">Cookie Settings</a></span></li></ul></div><div class="col footer__col"><div class="footer__title">Salesforce Developers</div><ul class="footer__items clean-list"><li class="footer__item"><span class="footer__item"><a href="https://developer.salesforce.com/docs/einstein/genai/guide/models-api.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Models API Dev Guide</a></span></li></ul></div><div class="col footer__col"><div class="footer__title">Salesforce Help</div><ul class="footer__items clean-list"><li class="footer__item"><span class="footer__item"><a href="https://help.salesforce.com/s/articleView?id=sf.generative_ai_about.htm" target="_blank" rel="noopener noreferrer" class="footer__link-item">Einstein Generative AI</a></span></li><li class="footer__item"><span class="footer__item"><a href="https://help.salesforce.com/s/articleView?id=sf.copilot_intro.htm" target="_blank" rel="noopener noreferrer" class="footer__link-item">Agentforce</a></span></li><li class="footer__item"><span class="footer__item"><a href="https://help.salesforce.com/s/articleView?id=sf.c360_a_ai_use_ai_models.htm" target="_blank" rel="noopener noreferrer" class="footer__link-item">Model Builder</a></span></li><li class="footer__item"><span class="footer__item"><a href="https://help.salesforce.com/s/articleView?id=sf.prompt_builder_about.htm" target="_blank" rel="noopener noreferrer" class="footer__link-item">Prompt Builder</a></span></li></ul></div><div class="col footer__col"><div class="footer__title">GitHub</div><ul class="footer__items clean-list"><li class="footer__item"><span class="footer__item"><a href="https://github.com/salesforce/einstein-platform" target="_blank" rel="noopener noreferrer" class="footer__link-item">Einstein Platform Repo</a></span></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright"><div class="margin-top--xl"><small>Copyright © 2025 Salesforce, Inc. All rights reserved. Various trademarks held by their respective owners. <br>Salesforce, Inc. Salesforce Tower, 415 Mission Street, 3rd Floor, San Francisco, CA 94105, United States.</small></div></div></div></div></footer></div>
</body>
</html>